{
  "question_name": "design-task-manager",
  "problem_metadata": {
    "questionId": "3678",
    "title": "Design Task Manager",
    "titleSlug": "design-task-manager",
    "content": "<p>There is a task management system that allows users to manage their tasks, each associated with a priority. The system should efficiently handle adding, modifying, executing, and removing tasks.</p>\n\n<p>Implement the <code>TaskManager</code> class:</p>\n\n<ul>\n\t<li>\n\t<p><code>TaskManager(vector&lt;vector&lt;int&gt;&gt;&amp; tasks)</code> initializes the task manager with a list of user-task-priority triples. Each element in the input list is of the form <code>[userId, taskId, priority]</code>, which adds a task to the specified user with the given priority.</p>\n\t</li>\n\t<li>\n\t<p><code>void add(int userId, int taskId, int priority)</code> adds a task with the specified <code>taskId</code> and <code>priority</code> to the user with <code>userId</code>. It is <strong>guaranteed</strong> that <code>taskId</code> does not <em>exist</em> in the system.</p>\n\t</li>\n\t<li>\n\t<p><code>void edit(int taskId, int newPriority)</code> updates the priority of the existing <code>taskId</code> to <code>newPriority</code>. It is <strong>guaranteed</strong> that <code>taskId</code> <em>exists</em> in the system.</p>\n\t</li>\n\t<li>\n\t<p><code>void rmv(int taskId)</code> removes the task identified by <code>taskId</code> from the system. It is <strong>guaranteed</strong> that <code>taskId</code> <em>exists</em> in the system.</p>\n\t</li>\n\t<li>\n\t<p><code>int execTop()</code> executes the task with the <strong>highest</strong> priority across all users. If there are multiple tasks with the same <strong>highest</strong> priority, execute the one with the highest <code>taskId</code>. After executing, the<strong> </strong><code>taskId</code><strong> </strong>is <strong>removed</strong> from the system. Return the <code>userId</code> associated with the executed task. If no tasks are available, return -1.</p>\n\t</li>\n</ul>\n\n<p><strong>Note</strong> that a user may be assigned multiple tasks.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong><br />\n<span class=\"example-io\">[&quot;TaskManager&quot;, &quot;add&quot;, &quot;edit&quot;, &quot;execTop&quot;, &quot;rmv&quot;, &quot;add&quot;, &quot;execTop&quot;]<br />\n[[[[1, 101, 10], [2, 102, 20], [3, 103, 15]]], [4, 104, 5], [102, 8], [], [101], [5, 105, 15], []]</span></p>\n\n<p><strong>Output:</strong><br />\n<span class=\"example-io\">[null, null, null, 3, null, null, 5] </span></p>\n\n<p><strong>Explanation</strong></p>\nTaskManager taskManager = new TaskManager([[1, 101, 10], [2, 102, 20], [3, 103, 15]]); // Initializes with three tasks for Users 1, 2, and 3.<br />\ntaskManager.add(4, 104, 5); // Adds task 104 with priority 5 for User 4.<br />\ntaskManager.edit(102, 8); // Updates priority of task 102 to 8.<br />\ntaskManager.execTop(); // return 3. Executes task 103 for User 3.<br />\ntaskManager.rmv(101); // Removes task 101 from the system.<br />\ntaskManager.add(5, 105, 15); // Adds task 105 with priority 15 for User 5.<br />\ntaskManager.execTop(); // return 5. Executes task 105 for User 5.</div>\n\n<p>&nbsp;</p>\n<p><strong>Constraints:</strong></p>\n\n<ul>\n\t<li><code>1 &lt;= tasks.length &lt;= 10<sup>5</sup></code></li>\n\t<li><code>0 &lt;= userId &lt;= 10<sup>5</sup></code></li>\n\t<li><code>0 &lt;= taskId &lt;= 10<sup>5</sup></code></li>\n\t<li><code>0 &lt;= priority &lt;= 10<sup>9</sup></code></li>\n\t<li><code>0 &lt;= newPriority &lt;= 10<sup>9</sup></code></li>\n\t<li>At most <code>2 * 10<sup>5</sup></code> calls will be made in <strong>total</strong> to <code>add</code>, <code>edit</code>, <code>rmv</code>, and <code>execTop</code> methods.</li>\n\t<li>The input is generated such that <code>taskId</code> will be valid.</li>\n</ul>\n",
    "difficulty": "Medium",
    "stats": "{\"totalAccepted\": \"101.2K\", \"totalSubmission\": \"206K\", \"totalAcceptedRaw\": 101222, \"totalSubmissionRaw\": 205997, \"acRate\": \"49.1%\"}",
    "topicTags": [
      {
        "name": "Hash Table",
        "slug": "hash-table",
        "translatedName": null
      },
      {
        "name": "Design",
        "slug": "design",
        "translatedName": null
      },
      {
        "name": "Heap (Priority Queue)",
        "slug": "heap-priority-queue",
        "translatedName": null
      },
      {
        "name": "Ordered Set",
        "slug": "ordered-set",
        "translatedName": null
      }
    ],
    "hints": []
  },
  "submissions": [
    {
      "id": "1775516269",
      "statusDisplay": "Accepted",
      "lang": {
        "name": "python3",
        "verboseName": "Python3"
      },
      "runtime": 2310,
      "memory": 98820000,
      "timestamp": 1758239717,
      "title": "Design Task Manager",
      "titleSlug": "design-task-manager",
      "runtimeDisplay": "2310 ms",
      "runtimePercentile": 5.119399999999882,
      "memoryDisplay": "98.8 MB",
      "memoryPercentile": 96.36339999999996,
      "code": "import bisect\n\nclass TaskManager:\n    def __init__(self, tasks):\n        self.mp = {}  # taskId -> (userId, priority)\n        self.st = []  # sorted list of (priority, taskId)\n\n        for userId, taskId, priority in tasks:\n            self.mp[taskId] = (userId, priority)\n            bisect.insort(self.st, (priority, taskId))\n\n    def add(self, userId, taskId, priority):\n        self.mp[taskId] = (userId, priority)\n        bisect.insort(self.st, (priority, taskId))\n\n    def edit(self, taskId, newPriority):\n        userId, oldPriority = self.mp[taskId]\n        idx = bisect.bisect_left(self.st, (oldPriority, taskId))\n        self.st.pop(idx)\n        self.mp[taskId] = (userId, newPriority)\n        bisect.insort(self.st, (newPriority, taskId))\n\n    def rmv(self, taskId):\n        userId, priority = self.mp[taskId]\n        idx = bisect.bisect_left(self.st, (priority, taskId))\n        self.st.pop(idx)\n        del self.mp[taskId]\n\n    def execTop(self):\n        if not self.mp:\n            return -1\n        priority, taskId = self.st.pop()  # highest priority\n        userId, _ = self.mp[taskId]\n        del self.mp[taskId]\n        return userId\n",
      "statusCode": 10,
      "user": {
        "username": "saachinnnnn",
        "profile": {
          "realName": "Iam4ari"
        }
      },
      "question": {
        "questionId": "3678",
        "titleSlug": "design-task-manager",
        "hasFrontendPreview": false
      },
      "notes": "",
      "flagType": "WHITE",
      "topicTags": [],
      "runtimeError": null,
      "compileError": null
    },
    {
      "id": "1775516026",
      "statusDisplay": "Wrong Answer",
      "lang": {
        "name": "python3",
        "verboseName": "Python3"
      },
      "runtime": 646,
      "memory": 98392000,
      "timestamp": 1758239677,
      "title": "Design Task Manager",
      "titleSlug": "design-task-manager",
      "runtimeDisplay": "N/A",
      "runtimePercentile": null,
      "memoryDisplay": "N/A",
      "memoryPercentile": null,
      "code": "import heapq\n\nclass Manager:\n    def __init__(self, userId, taskId, priority):\n        self.userId = userId\n        self.taskId = taskId\n        self.priority = priority\n\n    def __lt__(self, other):\n        if self.priority == other.priority:\n            return self.taskId > other.taskId  # higher taskId wins\n        return self.priority > other.priority  # higher priority wins\n\n\nclass TaskManager:\n    def __init__(self, tasks):\n        self.heap = []\n        self.record = {}  # taskId -> Manager\n        for userId, taskId, priority in tasks:\n            m = Manager(userId, taskId, priority)\n            heapq.heappush(self.heap, m)\n            self.record[taskId] = m\n\n    def add(self, userId, taskId, priority):\n        m = Manager(userId, taskId, priority)\n        heapq.heappush(self.heap, m)\n        self.record[taskId] = m\n\n    def edit(self, taskId, newPriority):\n        if taskId not in self.record:\n            return\n        old = self.record[taskId]\n        updated = Manager(old.userId, taskId, newPriority)\n        heapq.heappush(self.heap, updated)\n        self.record[taskId] = updated\n\n    def rmv(self, taskId):\n        if taskId in self.record:\n            del self.record[taskId]  # lazy delete\n\n    def execTop(self):\n        while self.heap:\n            top = heapq.heappop(self.heap)\n            latest = self.record.get(top.taskId)\n            if latest is None:\n                continue  # removed\n            if latest.priority != top.priority:\n                continue  # outdated\n            del self.record[top.taskId]\n            return top.userId\n        return -1",
      "statusCode": 11,
      "user": {
        "username": "saachinnnnn",
        "profile": {
          "realName": "Iam4ari"
        }
      },
      "question": {
        "questionId": "3678",
        "titleSlug": "design-task-manager",
        "hasFrontendPreview": false
      },
      "notes": "",
      "flagType": "WHITE",
      "topicTags": [],
      "runtimeError": null,
      "compileError": null
    }
  ]
}