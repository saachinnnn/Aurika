{
  "question_name": "separate-squares-ii",
  "problem_metadata": {
    "questionId": "3775",
    "title": "Separate Squares II",
    "titleSlug": "separate-squares-ii",
    "content": "<p>You are given a 2D integer array <code>squares</code>. Each <code>squares[i] = [x<sub>i</sub>, y<sub>i</sub>, l<sub>i</sub>]</code> represents the coordinates of the bottom-left point and the side length of a square parallel to the x-axis.</p>\n\n<p>Find the <strong>minimum</strong> y-coordinate value of a horizontal line such that the total area covered by squares above the line <em>equals</em> the total area covered by squares below the line.</p>\n\n<p>Answers within <code>10<sup>-5</sup></code> of the actual answer will be accepted.</p>\n\n<p><strong>Note</strong>: Squares <strong>may</strong> overlap. Overlapping areas should be counted <strong>only once</strong> in this version.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">squares = [[0,0,1],[2,2,1]]</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">1.00000</span></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p><img alt=\"\" src=\"https://assets.leetcode.com/uploads/2025/01/15/4065example1drawio.png\" style=\"width: 269px; height: 203px;\" /></p>\n\n<p>Any horizontal line between <code>y = 1</code> and <code>y = 2</code> results in an equal split, with 1 square unit above and 1 square unit below. The minimum y-value is 1.</p>\n</div>\n\n<p><strong class=\"example\">Example 2:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">squares = [[0,0,2],[1,1,1]]</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">1.00000</span></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p><img alt=\"\" src=\"https://assets.leetcode.com/uploads/2025/01/15/4065example2drawio.png\" style=\"width: 269px; height: 203px;\" /></p>\n\n<p>Since the blue square overlaps with the red square, it will not be counted again. Thus, the line <code>y = 1</code> splits the squares into two equal parts.</p>\n</div>\n\n<p>&nbsp;</p>\n<p><strong>Constraints:</strong></p>\n\n<ul>\n\t<li><code>1 &lt;= squares.length &lt;= 5 * 10<sup>4</sup></code></li>\n\t<li><code>squares[i] = [x<sub>i</sub>, y<sub>i</sub>, l<sub>i</sub>]</code></li>\n\t<li><code>squares[i].length == 3</code></li>\n\t<li><code>0 &lt;= x<sub>i</sub>, y<sub>i</sub> &lt;= 10<sup>9</sup></code></li>\n\t<li><code>1 &lt;= l<sub>i</sub> &lt;= 10<sup>9</sup></code></li>\n\t<li>The total area of all the squares will not exceed <code>10<sup>15</sup></code>.</li>\n</ul>\n",
    "difficulty": "Hard",
    "stats": "{\"totalAccepted\": \"60.1K\", \"totalSubmission\": \"99.9K\", \"totalAcceptedRaw\": 60112, \"totalSubmissionRaw\": 99917, \"acRate\": \"60.2%\"}",
    "topicTags": [
      {
        "name": "Array",
        "slug": "array",
        "translatedName": null
      },
      {
        "name": "Binary Search",
        "slug": "binary-search",
        "translatedName": null
      },
      {
        "name": "Segment Tree",
        "slug": "segment-tree",
        "translatedName": null
      },
      {
        "name": "Sweep Line",
        "slug": "line-sweep",
        "translatedName": null
      }
    ],
    "hints": [
      "Use a line sweep and a segment tree.",
      "The line must lie in one of the squares."
    ]
  },
  "submissions": [
    {
      "id": "1885094752",
      "statusDisplay": "Accepted",
      "lang": {
        "name": "python3",
        "verboseName": "Python3"
      },
      "runtime": 700,
      "memory": 60720000,
      "timestamp": 1768413078,
      "title": "Separate Squares II",
      "titleSlug": "separate-squares-ii",
      "runtimeDisplay": "700 ms",
      "runtimePercentile": 75.39049999999978,
      "memoryDisplay": "60.7 MB",
      "memoryPercentile": 56.305099999999804,
      "code": "class Solution:\n    def separateSquares(self, squares: List[List[int]]) -> float:\n        events = []\n        for x, y, l in squares:\n            events.append((y, 1, x, x + l))\n            events.append((y + l, -1, x, x + l))\n\n        events.sort()\n        xs = []\n        prev_y = events[0][0]\n        total = 0\n        areas = []\n\n        def union_len(intervals):\n            intervals.sort()\n            res = cur = 0\n            end = -10**30\n            for a, b in intervals:\n                if a > end:\n                    res += b - a\n                    end = b\n                elif b > end:\n                    res += b - end\n                    end = b\n            return res\n\n        for y, typ, x1, x2 in events:\n            if y > prev_y and xs:\n                h = y - prev_y\n                w = union_len(xs)\n                areas.append((prev_y, h, w))\n                total += h * w\n            if typ == 1:\n                xs.append((x1, x2))\n            else:\n                xs.remove((x1, x2))\n            prev_y = y\n\n        half = total / 2\n        acc = 0\n        for y, h, w in areas:\n            if acc + h * w >= half:\n                return y + (half - acc) / w\n            acc += h * w\n\n        return 0.0",
      "statusCode": 10,
      "user": {
        "username": "saachinnnnn",
        "profile": {
          "realName": "Iam4ari"
        }
      },
      "question": {
        "questionId": "3775",
        "titleSlug": "separate-squares-ii",
        "hasFrontendPreview": false
      },
      "notes": "",
      "flagType": "WHITE",
      "topicTags": [],
      "runtimeError": null,
      "compileError": null
    }
  ]
}