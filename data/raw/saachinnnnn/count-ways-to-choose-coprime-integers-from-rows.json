{
  "question_name": "count-ways-to-choose-coprime-integers-from-rows",
  "problem_metadata": {
    "questionId": "4069",
    "title": "Count Ways to Choose Coprime Integers from Rows",
    "titleSlug": "count-ways-to-choose-coprime-integers-from-rows",
    "content": "<p>You are given a <code>m x n</code> matrix <code>mat</code> of positive integers.</p>\n\n<p>Return an integer denoting the number of ways to choose <strong>exactly one</strong> integer from each row of <code>mat</code> such that the <strong>greatest common divisor</strong> of all chosen integers is 1.</p>\n\n<p>Since the answer may be very large, return it <strong>modulo</strong> <code>10<sup>9</sup> + 7</code>.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">mat = [[1,2],[3,4]]</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">3</span></p>\n\n<p><strong>Explanation:</strong></p>\n\n<table style=\"border: 1px solid black;\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<th align=\"center\" style=\"border: 1px solid black;\">Chosen integer in the first row</th>\n\t\t\t<th align=\"center\" style=\"border: 1px solid black;\">Chosen integer in the second row</th>\n\t\t\t<th align=\"center\" style=\"border: 1px solid black;\">Greatest common divisor of chosen integers</th>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td align=\"center\" style=\"border: 1px solid black;\">1</td>\n\t\t\t<td align=\"center\" style=\"border: 1px solid black;\">3</td>\n\t\t\t<td align=\"center\" style=\"border: 1px solid black;\">1</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td align=\"center\" style=\"border: 1px solid black;\">1</td>\n\t\t\t<td align=\"center\" style=\"border: 1px solid black;\">4</td>\n\t\t\t<td align=\"center\" style=\"border: 1px solid black;\">1</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td align=\"center\" style=\"border: 1px solid black;\">2</td>\n\t\t\t<td align=\"center\" style=\"border: 1px solid black;\">3</td>\n\t\t\t<td align=\"center\" style=\"border: 1px solid black;\">1</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td align=\"center\" style=\"border: 1px solid black;\">2</td>\n\t\t\t<td align=\"center\" style=\"border: 1px solid black;\">4</td>\n\t\t\t<td align=\"center\" style=\"border: 1px solid black;\">2</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p>3 of these combinations have a greatest common divisor of 1. Therefore, the answer is 3.</p>\n</div>\n\n<p><strong class=\"example\">Example 2:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong> <span class=\"example-io\">mat = [[2,2],[2,2]]</span></p>\n\n<p><strong>Output:</strong> <span class=\"example-io\">0</span></p>\n\n<p><strong>Explanation:</strong></p>\n\n<p>Every combination has a greatest common divisor of 2. Therefore, the answer is 0.</p>\n</div>\n\n<p>&nbsp;</p>\n<p><strong>Constraints:</strong></p>\n\n<ul>\n\t<li><code>1 &lt;= m == mat.length &lt;= 150</code></li>\n\t<li><code>1 &lt;= n == mat[i].length &lt;= 150</code></li>\n\t<li><code>1 &lt;= mat[i][j] &lt;= 150</code></li>\n</ul>\n",
    "difficulty": "Hard",
    "stats": "{\"totalAccepted\": \"9.3K\", \"totalSubmission\": \"19.3K\", \"totalAcceptedRaw\": 9315, \"totalSubmissionRaw\": 19302, \"acRate\": \"48.3%\"}",
    "topicTags": [
      {
        "name": "Array",
        "slug": "array",
        "translatedName": null
      },
      {
        "name": "Math",
        "slug": "math",
        "translatedName": null
      },
      {
        "name": "Dynamic Programming",
        "slug": "dynamic-programming",
        "translatedName": null
      },
      {
        "name": "Matrix",
        "slug": "matrix",
        "translatedName": null
      },
      {
        "name": "Combinatorics",
        "slug": "combinatorics",
        "translatedName": null
      },
      {
        "name": "Number Theory",
        "slug": "number-theory",
        "translatedName": null
      }
    ],
    "hints": [
      "Use dynamic programming.",
      "Use <code>dp[row][g]</code>, where <code>row</code> is the current row and <code>g</code> is the current gcd value.",
      "Initialize the first row: for each value <code>v</code> in row 0 do <code>dp[0][v] += 1</code>.",
      "For a row <code>i</code>, use the values from the previous row <code>i - 1</code> to build the values: for each previous gcd <code>g</code> and each value <code>v</code> in row <code>i</code>.",
      "The final answer is <code>dp[n-1][1]</code> (number of ways with gcd 1)."
    ]
  },
  "submissions": [
    {
      "id": "1811303728",
      "statusDisplay": "Accepted",
      "lang": {
        "name": "python3",
        "verboseName": "Python3"
      },
      "runtime": 1231,
      "memory": 18884000,
      "timestamp": 1761404662,
      "title": "Count Ways to Choose Coprime Integers from Rows",
      "titleSlug": "count-ways-to-choose-coprime-integers-from-rows",
      "runtimeDisplay": "1231 ms",
      "runtimePercentile": 66.66750000000005,
      "memoryDisplay": "18.9 MB",
      "memoryPercentile": 88.8889,
      "code": "import math\nfrom typing import List\nclass Solution:\n    def countCoprime(self, mat: List[List[int]]) -> int:\n        MOD = 10**9 + 7\n        m = len(mat)\n        n = len(mat[0])\n        dp = [0] * 151\n        for num in mat[0]:\n            if num <= 150:\n                dp[num] = (dp[num] + 1) % MOD\n\n        for i in range(1,m):\n            newdp = [0] * 151\n            for g in range(1,151):\n                if dp[g] == 0:\n                    continue\n                for num in mat[i]:\n                    newg = math.gcd(g,num)\n                    if newg <= 150:\n                        newdp[newg] = (newdp[newg] + dp[g]) % MOD\n            dp = newdp\n        return dp[1] % MOD",
      "statusCode": 10,
      "user": {
        "username": "saachinnnnn",
        "profile": {
          "realName": "Iam4ari"
        }
      },
      "question": {
        "questionId": "4069",
        "titleSlug": "count-ways-to-choose-coprime-integers-from-rows",
        "hasFrontendPreview": false
      },
      "notes": "",
      "flagType": "WHITE",
      "topicTags": [],
      "runtimeError": null,
      "compileError": null
    }
  ]
}